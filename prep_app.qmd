---
title: "prep_app"
format: html
author: Powell Braddock
---

# Numerical Summaries for Investigating the Data

## One-Way Contingency Tables

```{r}
library(tidyverse)
melbourne_house_data <- read_csv('MELBOURNE_HOUSE_PRICES_LESS.csv')
melbourne_house_data <- 
  melbourne_house_data |> 
  mutate(Full_Date = as.Date(Date, format = "%m/%d/%Y"))

melbourne_house_data
```

```{r}
melbourne_house_data |>
  group_by(Regionname) |>
  summarize(count = n())
```

```{r}
melbourne_house_data |>
  group_by(Suburb) |>
  summarize(count = n())
```

## Two-Way Contingency Tables

```{r}
melbourne_house_data |>
  group_by(Suburb, Type) |>
  summarize(count = n()) |>
  pivot_wider(names_from = Type, values_from = count)
```

## Numerical Summaries for Quantitative Variables at Levels of Categorical Variables

```{r}
melbourne_house_data |>
  group_by(Suburb, Type) |>
  drop_na(Suburb, Type) |>
  summarize(mean_price = mean(Price, na.rm = TRUE), med_price = median(Price, na.rm = TRUE),mean_rooms = mean(Rooms, na.rm = TRUE), med_rooms = median(Rooms, na.rm = TRUE))
```

```{r}
melbourne_house_data |>
  group_by(Region = as.factor(Regionname)) |>
  summarize(mean_price = mean(Price, na.rm = TRUE), med_price = median(Price, na.rm = TRUE),sd_price = sd(Price, na.rm = TRUE)) 
```

```{r}
melbourne_house_data |>
  group_by(Regionname = factor(Regionname), Type = factor(Type)) |>
  summarize(mean_price = mean(Price, na.rm = TRUE), med_price = median(Price, na.rm = TRUE),sd_price = sd(Price, na.rm = TRUE),mean_rooms = mean(Rooms, na.rm = TRUE), med_rooms = median(Rooms, na.rm = TRUE), sd_rooms = sd(Rooms, na.rm = TRUE)) 
```

Measures of Association between two numeric variables: price and number of rooms using pairwise complete observations.

```{r}
melbourne_house_data |>
  group_by(Regionname = factor(Regionname), Type = factor(Type)) |>
  summarize(correlation = cor(Price, Rooms, use = 'pairwise.complete.obs')) |>
  arrange(desc(correlation))
```

# Graphical Summaries for Investigating the Data

```{r}
g <- ggplot(melbourne_house_data |> drop_na(Price, Distance) |> 
            filter(Distance > 0),aes(x = Price, y = Distance))
g + geom_point() +
  ggtitle('Scatter Plot of Distance from Central Business District versus Price')+
  theme_dark()

```

```{r}
g3 <- ggplot(melbourne_house_data |>
               drop_na(Price, Type), aes(x=Price))
g3+geom_density(alpha=0.5, aes(fill=Type)) + theme_dark() +ggtitle('Histogram of Frequency of Price for Each House Type')
```

```{r}
g2 <- ggplot(melbourne_house_data |> drop_na(Regionname, Method), aes(x = Regionname, fill = Method))
g2 + geom_bar() +
  ggtitle('Bar Plot of Count of Houses Sold by Region over Method of Sale') +
  theme_dark() + coord_flip()
```

```{r}
g4 <- ggplot(melbourne_house_data |> drop_na(Type, Propertycount), aes(x = Type, y=Propertycount, fill=Type))
g4 + geom_boxplot() +
  ggtitle('Boxplots of Property Count versus Type') +
  theme_dark()
```

```{r}
g2 <- ggplot(melbourne_house_data |> drop_na(Type, Propertycount, Method, Regionname), aes(x = Type, y=Propertycount,fill=Method))
g2 + geom_boxplot() +
  ggtitle('Facet of Boxplots of Property Count versus Type across Sale Method and Regions') +
  facet_wrap(~ Regionname) +
  theme_dark()
```

```{r}
melbourne_house_data <- 
  melbourne_house_data |> 
  filter(Distance>0) |>
  mutate(Full_Date = factor(Full_Date))

melbourne_house_data <- melbourne_house_data |>
  complete(Suburb, Full_Date, fill=list(Distance=NA, Price=NA, Propertycount=NA, Regionname=NA)) |>
  filter(Method %in% c('PI', 'S', 'SA', 'SP', 'VB')
  )
```

```{r}
library(ggplot2)
library(gapminder)
library(gganimate)

p <- ggplot(melbourne_house_data, aes(Distance, Price, size = Propertycount, colour = Regionname)) +
  geom_point(alpha = 0.7, show.legend = TRUE) +

  scale_colour_discrete() +
  scale_size(range = c(2, 12)) +
  scale_x_log10() +
  facet_wrap(~Method) +
  # Here comes the gganimate specific bits
  labs(title = 'Year: {closest_state}', x = 'Distance from Central Business District', y = 'Price') +
  transition_states(Full_Date, transition_length = 3, state_length = 3) +
  enter_fade()+exit_fade() + ggtitle('Price versus Distancce from CBD over Time by Method of Sale')
#  ease_aes('linear')

```

```{r, echo=FALSE}
animate(p)
```
